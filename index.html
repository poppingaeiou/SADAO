<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Sarabun', sans-serif; background-color: #f4f6f4; margin: 0; display: flex; flex-direction: column; height: 100vh; }
    .header { background: #4CAF50; color: white; padding: 15px; text-align: center; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .header img { width: 45px; height: 45px; border-radius: 50%; border: 2px solid #fff; }
    #chat-box { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
    .msg-row { display: flex; gap: 10px; }
    .avatar { width: 40px; height: 40px; border-radius: 50%; border: 1px solid #ddd; object-fit: cover; }
    .msg { padding: 12px 16px; border-radius: 15px; max-width: 80%; line-height: 1.5; font-size: 16px; word-wrap: break-word; }
    .bot { background: white; color: #333; border-top-left-radius: 0; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
    .user { background: #4CAF50; color: white; border-bottom-right-radius: 0; align-self: flex-end; margin-left: auto; box-shadow: 0 1px 2px rgba(0,0,0,0.2); }
    .input-area { padding: 10px; background: white; display: flex; gap: 10px; border-top: 1px solid #ddd; }
    input { flex: 1; padding: 12px; border-radius: 25px; border: 1px solid #ddd; outline: none; font-size: 16px; }
    button { background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer; font-size: 16px; }
    .loading { font-size: 12px; color: #888; font-style: italic; margin-left: 60px; display: none; }
  </style>
</head>
<body>

<div class="header">
  <img src="https://img5.pic.in.th/file/secure-sv1/c368f6f06db807a94db5c7cf939baf76.png">
  <div>
    <div style="font-weight:600; font-size:18px;">‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏∞‡πÄ‡∏î‡∏≤</div>
    <div style="font-size:12px; opacity:0.9;">‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢</div>
  </div>
</div>

<div id="chat-box">
  <div class="msg-row">
    <img src="https://img5.pic.in.th/file/secure-sv1/c368f6f06db807a94db5c7cf939baf76.png" class="avatar">
    <div class="msg bot">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ ‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏∞‡πÄ‡∏î‡∏≤ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏∞ üåø<br>‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏≤‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡∏¥‡∏ß‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞</div>
  </div>
</div>
<div class="loading" id="loader">‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏∞‡πÄ‡∏î‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏¥‡∏î...</div>

<div class="input-area">
  <input type="text" id="txt" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°..." onkeypress="if(event.key==='Enter') send()">
  <button onclick="send()">‡∏™‡πà‡∏á</button>
</div>

<script>
  function send() {
    var txt = document.getElementById('txt').value.trim();
    if(!txt) return;
    
    addMsg(txt, 'user');
    document.getElementById('txt').value = '';
    document.getElementById('loader').style.display = 'block';

    google.script.run.withSuccessHandler(function(reply) {
      document.getElementById('loader').style.display = 'none';
      addMsg(reply, 'bot');
    }).processMessage(txt);
  }

  function addMsg(html, role) {
    var box = document.getElementById('chat-box');
    if(role === 'bot') {
      var div = document.createElement('div');
      div.className = 'msg-row';
      div.innerHTML = `<img src="https://img5.pic.in.th/file/secure-sv1/c368f6f06db807a94db5c7cf939baf76.png" class="avatar"><div class="msg bot">${html}</div>`;
      box.appendChild(div);
    } else {
      var div = document.createElement('div');
      div.className = 'msg user'; // user uses flex-self handling in CSS, no row wrapper needed mostly but keeping structured
      div.innerHTML = html;
      box.appendChild(div);
    }
    box.scrollTop = box.scrollHeight;
  }
</script>

</body>
</html>
