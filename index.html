<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏∞‡πÄ‡∏î‡∏≤ - ‡∏£‡∏û.‡∏™‡∏∞‡πÄ‡∏î‡∏≤</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    /* CSS ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì */
    body { font-family: 'Sarabun', sans-serif; background-color: #f4f6f4; margin: 0; display: flex; flex-direction: column; height: 100vh; }
    .header { background: #4CAF50; color: white; padding: 15px; text-align: center; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .header img { width: 45px; height: 45px; border-radius: 50%; border: 2px solid #fff; }
    #chat-box { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
    .msg-row { display: flex; gap: 10px; }
    .avatar { width: 40px; height: 40px; border-radius: 50%; border: 1px solid #ddd; object-fit: cover; }
    .msg { padding: 12px 16px; border-radius: 15px; max-width: 80%; line-height: 1.5; font-size: 16px; word-wrap: break-word; }
    .bot { background: white; color: #333; border-top-left-radius: 0; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
    .user { background: #4CAF50; color: white; border-bottom-right-radius: 0; align-self: flex-end; margin-left: auto; box-shadow: 0 1px 2px rgba(0,0,0,0.2); }
    .input-area { padding: 10px; background: white; display: flex; gap: 10px; border-top: 1px solid #ddd; }
    input { flex: 1; padding: 12px; border-radius: 25px; border: 1px solid #ddd; outline: none; font-size: 16px; }
    button { background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer; font-size: 16px; }
    .loading { font-size: 12px; color: #888; font-style: italic; margin-left: 60px; display: none; }
  </style>
</head>
<body>

<div class="header">
  <img src="https://img5.pic.in.th/file/secure-sv1/c368f6f06db807a94db5c7cf939baf76.png">
  <div>
    <div style="font-weight:600; font-size:18px;">‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏∞‡πÄ‡∏î‡∏≤</div>
    <div style="font-size:12px; opacity:0.9;">‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢ (GitHub Ver.)</div>
  </div>
</div>

<div id="chat-box">
  <div class="msg-row">
    <img src="https://img5.pic.in.th/file/secure-sv1/c368f6f06db807a94db5c7cf939baf76.png" class="avatar">
    <div class="msg bot">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ ‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏∞‡πÄ‡∏î‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô GitHub ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞ üåø<br>‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏°‡∏≤‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞</div>
  </div>
</div>
<div class="loading" id="loader">‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏∞‡πÄ‡∏î‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏¥‡∏î...</div>

<div class="input-area">
  <input type="text" id="txt" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°..." onkeypress="if(event.key==='Enter') send()">
  <button onclick="send()">‡∏™‡πà‡∏á</button>
</div>

<script>
  // ********************************************************
  // üî¥ ‡πÄ‡∏≠‡∏≤‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≤‡∏Å Google Script (/exec) ‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ üî¥
  const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyQKDaHWzzb2PIuend4HS62cDD0qrGQmtFOzvKMYBzNGcv7Wj4LxVsTz_HfAmtvJbbzsA/exec"; 
  // ********************************************************

  function send() {
    var txt = document.getElementById('txt').value.trim();
    if(!txt) return;
    
    addMsg(txt, 'user');
    document.getElementById('txt').value = '';
    document.getElementById('loader').style.display = 'block';

    // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å google.script.run ‡πÄ‡∏õ‡πá‡∏ô fetch() ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏¢‡∏Ç‡πâ‡∏≤‡∏° Server
    fetch(GOOGLE_SCRIPT_URL, {
      method: "POST",
      body: JSON.stringify({ message: txt }),
      // ‡πÉ‡∏ä‡πâ text/plain ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤ CORS ‡∏Ç‡∏≠‡∏á Google
      headers: { "Content-Type": "text/plain;charset=utf-8" } 
    })
    .then(response => response.json())
    .then(data => {
      document.getElementById('loader').style.display = 'none';
      addMsg(data.reply, 'bot');
    })
    .catch(error => {
      document.getElementById('loader').style.display = 'none';
      addMsg("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ñ‡πà‡∏∞", 'bot');
      console.error('Error:', error);
    });
  }

  function addMsg(html, role) {
    var box = document.getElementById('chat-box');
    var div = document.createElement('div');
    if(role === 'bot') {
      div.className = 'msg-row';
      div.innerHTML = `<img src="https://img5.pic.in.th/file/secure-sv1/c368f6f06db807a94db5c7cf939baf76.png" class="avatar"><div class="msg bot">${html}</div>`;
    } else {
      div.className = 'msg user';
      div.innerHTML = html;
      div.style.marginLeft = "auto";
    }
    box.appendChild(div);
    box.scrollTop = box.scrollHeight;
  }
</script>

</body>
</html>
